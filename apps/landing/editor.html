<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BPMN Editor — bpmn-sdk</title>
    <style>
      *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
      body { height: 100dvh; overflow: hidden; font-family: system-ui, sans-serif; font-size: 13px; }

      /* Canvas fills the full viewport */
      #editor-container { position: fixed; inset: 0; }
      /* Hide the default zoom controls added by the editor */
      #editor-container .bpmn-controls { display: none; }

      /* ── HUD base ──────────────────────────────────────────────────────── */
      .hud { position: fixed; z-index: 100; }

      .panel {
        display: flex;
        align-items: center;
        gap: 2px;
        padding: 4px;
        background: rgba(22, 22, 30, 0.88);
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 10px;
        box-shadow: 0 2px 16px rgba(0, 0, 0, 0.4);
      }

      /* ── HUD positions ─────────────────────────────────────────────────── */
      #hud-top-center { top: 10px; left: 50%; transform: translateX(-50%); }
      #hud-bottom-left   { bottom: 10px; left: 10px; }
      #hud-bottom-center { bottom: 10px; left: 50%; transform: translateX(-50%); }
      #ctx-toolbar { display: none; transform: translateX(-50%); }
      #cfg-toolbar { display: none; transform: translate(-50%, -100%); }

      /* ── Icon buttons ──────────────────────────────────────────────────── */
      .hud-btn {
        display: flex; align-items: center; justify-content: center;
        width: 32px; height: 32px;
        background: transparent;
        border: 1px solid transparent;
        border-radius: 6px;
        color: rgba(255, 255, 255, 0.65);
        cursor: pointer;
        transition: background 0.1s, color 0.1s, border-color 0.1s;
        padding: 0; flex-shrink: 0;
      }
      .hud-btn:hover  { background: rgba(255,255,255,0.08); color: #fff; }
      .hud-btn.active { background: rgba(255,255,255,0.12); color: #fff; border-color: rgba(255,255,255,0.2); }
      .hud-btn:disabled { opacity: 0.28; cursor: default; }
      .hud-btn:disabled:hover { background: transparent; color: rgba(255,255,255,0.65); }
      .hud-btn svg { width: 16px; height: 16px; pointer-events: none; }

      /* ── Group button: small chevron at bottom-right corner ────────────── */
      .hud-btn[data-group] { position: relative; }
      .hud-btn[data-group]::after {
        content: '';
        position: absolute;
        bottom: 3px; right: 3px;
        width: 0; height: 0;
        border-left: 3px solid transparent;
        border-top: 3px solid currentColor;
        opacity: 0.55;
      }

      /* ── Separator ─────────────────────────────────────────────────────── */
      .hud-sep { width: 1px; height: 20px; background: rgba(255,255,255,0.1); margin: 0 2px; flex-shrink: 0; }

      /* ── Zoom widget ───────────────────────────────────────────────────── */
      #btn-zoom-current {
        padding: 0 10px; height: 32px;
        background: transparent; border: 1px solid transparent; border-radius: 7px;
        color: rgba(255,255,255,0.65); cursor: pointer;
        font-size: 12px; font-weight: 600;
        transition: background 0.1s, color 0.1s;
        white-space: nowrap;
      }
      #btn-zoom-current:hover { background: rgba(255,255,255,0.08); color: #fff; }

      #zoom-expanded { display: none; align-items: center; gap: 2px; }
      #zoom-expanded.open { display: flex; }

      #btn-zoom-pct {
        padding: 0 8px; height: 30px;
        background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.1); border-radius: 6px;
        color: rgba(255,255,255,0.8); cursor: pointer;
        font-size: 12px; font-weight: 600;
        transition: background 0.1s;
        white-space: nowrap; min-width: 60px; text-align: center;
      }
      #btn-zoom-pct:hover { background: rgba(255,255,255,0.12); }

      /* ── Dropdown menus ────────────────────────────────────────────────── */
      .dropdown {
        position: fixed; display: none; flex-direction: column;
        gap: 1px; padding: 4px;
        background: rgba(20, 20, 28, 0.96);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 9px;
        box-shadow: 0 6px 24px rgba(0,0,0,0.5);
        z-index: 200; min-width: 150px;
      }
      .dropdown.open { display: flex; }

      .drop-item {
        display: flex; align-items: center; gap: 8px;
        padding: 7px 10px;
        border: none; background: transparent;
        color: rgba(255,255,255,0.75); cursor: pointer;
        border-radius: 6px; font-size: 12px; text-align: left; width: 100%;
        transition: background 0.1s;
      }
      .drop-item:hover { background: rgba(255,255,255,0.08); color: #fff; }
      .drop-item .di-check { width: 14px; height: 14px; flex-shrink: 0; color: #4c8ef7; }
      .drop-item .di-icon  { width: 14px; height: 14px; flex-shrink: 0; opacity: 0.7; }
      .drop-item svg { width: 14px; height: 14px; }
      .drop-sep { height: 1px; background: rgba(255,255,255,0.08); margin: 3px 0; }

      /* Theme submenu label */
      .drop-label {
        padding: 4px 10px 2px;
        font-size: 10px; font-weight: 600; letter-spacing: 0.06em;
        color: rgba(255,255,255,0.3); text-transform: uppercase;
      }

      /* ── Group element picker (horizontal, appears above group button) ── */
      .group-picker {
        position: fixed;
        display: flex; flex-direction: row;
        gap: 2px; padding: 4px;
        background: rgba(20, 20, 28, 0.96);
        backdrop-filter: blur(12px);
        border: 1px solid rgba(255,255,255,0.1);
        border-radius: 9px;
        box-shadow: 0 6px 24px rgba(0,0,0,0.5);
        z-index: 300;
      }
      .group-picker-label {
        padding: 2px 6px 4px;
        font-size: 10px; font-weight: 600; letter-spacing: 0.05em;
        color: rgba(255,255,255,0.3); text-transform: uppercase;
        white-space: nowrap; align-self: center;
        border-right: 1px solid rgba(255,255,255,0.08);
        margin-right: 2px;
      }
    </style>
  </head>
  <body>
    <!-- Canvas fills viewport -->
    <div id="editor-container"></div>

    <!-- Top center: action bar -->
    <div id="hud-top-center" class="hud panel">
      <button id="btn-undo"      class="hud-btn" title="Undo (Ctrl+Z)"></button>
      <button id="btn-redo"      class="hud-btn" title="Redo (Ctrl+Y)"></button>
      <div class="hud-sep"></div>
      <button id="btn-delete"    class="hud-btn" title="Delete"></button>
      <button id="btn-duplicate" class="hud-btn" title="Duplicate (Ctrl+D)"></button>
      <div class="hud-sep"></div>
      <button id="btn-top-more"  class="hud-btn" title="More actions"></button>
    </div>

    <!-- Bottom left: zoom control -->
    <div id="hud-bottom-left" class="hud panel">
      <button id="btn-zoom-current">100%</button>
      <div id="zoom-expanded">
        <button id="btn-zoom-out" class="hud-btn" title="Zoom out (−)"></button>
        <button id="btn-zoom-pct">100% ▾</button>
        <button id="btn-zoom-in"  class="hud-btn" title="Zoom in (+)"></button>
      </div>
    </div>

    <!-- Bottom center: tool bar (select/pan static, element groups built by JS) -->
    <div id="hud-bottom-center" class="hud panel">
      <button id="btn-select" class="hud-btn active" title="Select (V)"></button>
      <button id="btn-pan"    class="hud-btn"        title="Hand (H)"></button>
      <button id="btn-space"  class="hud-btn"        title="Space tool"></button>
      <div class="hud-sep"></div>
      <div id="tool-groups" style="display:flex;align-items:center;gap:2px;"></div>
    </div>

    <!-- Configure toolbar (above selected element) -->
    <div id="cfg-toolbar" class="hud panel"></div>

    <!-- Contextual quick-add toolbar (below selected element) -->
    <div id="ctx-toolbar" class="hud panel"></div>

    <!-- Dropdown menus -->
    <div id="zoom-menu"      class="dropdown"></div>
    <div id="more-menu"      class="dropdown"></div>
    <div id="label-pos-menu" class="dropdown"></div>

    <script type="module" src="/src/editor.ts"></script>
  </body>
</html>
